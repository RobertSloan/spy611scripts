--
-- ~/spy611/script/ma/rpt_np.sql
--
-- For now this is a simple rpt.
-- Summarize first:
SELECT CORR(prob_willbetrue,pctgain) FROM np_n1dg WHERE algo='gbm';
        corr        
--------------------
 0.0727027533844892
(1 row)

SELECT CORR(prob_willbetrue,pctgain) FROM np_n2dg WHERE algo='gbm';
        corr        
--------------------
 0.0467055159005512
(1 row)

SELECT CORR(prob_willbetrue,pctgain) FROM np_n1wg WHERE algo='gbm';
        corr        
--------------------
 0.0961411928720593
(1 row)

-- Yr drilldown:
SELECT TO_CHAR(ydate,'YYYY') yyyy,COUNT(ydate) pcount,CORR(prob_willbetrue,pctgain) FROM np_n1dg WHERE algo='gbm' GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY');
 yyyy | pcount |         corr         
------+--------+----------------------
 2000 |    252 |    0.160074543553055
 2001 |    248 |  0.00742420365981548
 2002 |    252 | -0.00213693796925486
 2003 |    252 |   -0.068818556021206
 2004 |    252 |   0.0556411571999529
 2005 |    252 |   0.0114419120526296
 2006 |    251 |     0.16858267785303
 2007 |    251 |   0.0480021902341501
 2008 |    253 |    0.176641496663855
 2009 |    252 |    0.063418785281067
 2010 |    252 |   0.0443594514110532
 2011 |    252 |   0.0228733009070924
 2012 |    250 |  0.00341482307062779
 2013 |    252 |    0.120251543264376
 2014 |     68 |    0.103450181562163
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,COUNT(ydate) pcount,CORR(prob_willbetrue,pctgain) FROM np_n2dg WHERE algo='gbm' GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY');
 yyyy | pcount |        corr         
------+--------+---------------------
 2000 |    252 |   0.123176250471642
 2001 |    248 |  0.0341178499584091
 2002 |    252 |  0.0595086274707239
 2003 |    252 | -0.0797181879441831
 2004 |    252 |  0.0479296290251328
 2005 |    252 |  0.0509584153421208
 2006 |    251 |   0.124857807233923
 2007 |    251 |  0.0976751018338343
 2008 |    253 |   0.149359222849792
 2009 |    252 | -0.0313817662332923
 2010 |    252 |  0.0476860315638197
 2011 |    252 |  0.0422781838289917
 2012 |    250 |  0.0841307152290392
 2013 |    252 |   0.105150287505635
 2014 |     68 |   0.268994385655123
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,COUNT(ydate) pcount,CORR(prob_willbetrue,pctgain) FROM np_n1wg WHERE algo='gbm' GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY');
 yyyy | pcount |         corr         
------+--------+----------------------
 2000 |    252 |    0.211515784585469
 2001 |    248 |    0.116962675825855
 2002 |    252 |    0.122230872948812
 2003 |    252 |   -0.045724567208471
 2004 |    252 | 0.000690988436282598
 2005 |    252 |   0.0360304814786288
 2006 |    251 |    0.215459015632971
 2007 |    251 |    0.297230979570884
 2008 |    253 |    0.196413889955262
 2009 |    252 |  -0.0686045422591221
 2010 |    252 |    0.159834353784572
 2011 |    252 |    0.179464112013679
 2012 |    250 |    0.237766602939829
 2013 |    252 |    0.182716468745153
 2014 |     68 |    0.212550065758651
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.07176470588235294118 |    153
 2001 | -0.01812903225806451613 |    155
 2002 | -0.09902097902097902098 |    143
 2003 |  0.04260869565217391304 |     92
 2004 | -0.01640350877192982456 |    114
 2005 |  0.04253012048192771084 |    166
 2006 |  0.21583333333333333333 |     72
 2007 |  0.08167741935483870968 |    155
 2008 |  0.18482993197278911565 |    147
 2009 |  0.19460869565217391304 |    115
 2010 |  0.01076388888888888889 |    144
 2011 | -0.03759493670886075949 |    158
 2012 |  0.07262886597938144330 |    194
 2013 |  0.14930069930069930070 |    143
 2014 |  0.09547619047619047619 |     42
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.07982248520710059172 |    169
 2001 | -0.07379679144385026738 |    187
 2002 | -0.10081250000000000000 |    160
 2003 | -0.07407407407407407407 |     54
 2004 |  0.09564885496183206107 |    131
 2005 |  0.08303571428571428571 |    168
 2006 |  0.23318181818181818182 |     66
 2007 |  0.07792452830188679245 |    159
 2008 | -0.15806250000000000000 |    160
 2009 |  0.11490196078431372549 |    102
 2010 |  0.18784615384615384615 |    130
 2011 |  0.02564971751412429379 |    177
 2012 |  0.17368686868686868687 |    198
 2013 |  0.22408759124087591241 |    137
 2014 |  0.21166666666666666667 |     38
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.17703910614525139665 |    179
 2001 | -0.22692737430167597765 |    179
 2002 | -0.38797101449275362319 |    138
 2003 |  0.15011363636363636364 |     88
 2004 |  0.12632000000000000000 |    125
 2005 |  0.18211453744493392070 |    227
 2006 |  0.81108108108108108108 |     37
 2007 |  0.48614754098360655738 |    122
 2008 | -0.34641509433962264151 |    159
 2009 |  0.03684210526315789474 |     95
 2010 |  0.67603174603174603175 |    126
 2011 |  0.34737430167597765363 |    179
 2012 |  0.41550802139037433155 |    187
 2013 |  0.55780645161290322581 |    155
 2014 |  0.61512820512820512821 |     43
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.21232323232323232323 |     99
 2001 | -0.05881720430107526882 |     93
 2002 | -0.05825688073394495413 |    109
 2003 |  0.10831250000000000000 |    160
 2004 |  0.07710144927536231884 |    138
 2005 | -0.01255813953488372093 |     86
 2006 | -0.02256983240223463687 |    179
 2007 | -0.09687500000000000000 |     96
 2008 | -0.59188679245283018868 |    106
 2009 |  0.00554744525547445255 |    137
 2010 |  0.10740740740740740741 |    108
 2011 |  0.09648936170212765957 |     94
 2012 |  0.00589285714285714286 |     56
 2013 |  0.01605504587155963303 |    109
 2014 | -0.06640000000000000000 |     26
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.30096385542168674699 |     83
 2001 | -0.10983606557377049180 |     61
 2002 | -0.28250000000000000000 |     92
 2003 |  0.23949494949494949495 |    198
 2004 |  0.02024793388429752066 |    121
 2005 | -0.00726190476190476190 |     84
 2006 |  0.03983783783783783784 |    185
 2007 | -0.06728260869565217391 |     92
 2008 | -0.52505376344086021505 |     93
 2009 |  0.23086666666666666667 |    150
 2010 |  0.01106557377049180328 |    122
 2011 |  0.01813333333333333333 |     75
 2012 | -0.11211538461538461538 |     52
 2013 |  0.13591304347826086957 |    115
 2014 | -0.13133333333333333333 |     30
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.84150684931506849315 |     73
 2001 | -0.11217391304347826087 |     69
 2002 | -0.44359649122807017544 |    114
 2003 |  0.57774390243902439024 |    164
 2004 |  0.12669291338582677165 |    127
 2005 | -0.12960000000000000000 |     25
 2006 |  0.10532710280373831776 |    214
 2007 | -0.39635658914728682171 |    129
 2008 |     -1.4448936170212766 |     94
 2009 |  0.75414012738853503185 |    157
 2010 | -0.17492063492063492063 |    126
 2011 | -0.66164383561643835616 |     73
 2012 | -0.10968253968253968254 |     63
 2013 |  0.30422680412371134021 |     97
 2014 | -0.61041666666666666667 |     25
(15 rows)

--
SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.17467289719626168224 |    107
 2001 | -0.03288659793814432990 |     97
 2002 | -0.02390000000000000000 |    100
 2003 |  0.14346153846153846154 |     26
 2004 |  0.20575757575757575758 |     33
 2005 |  0.04659574468085106383 |     47
 2006 |  0.42714285714285714286 |     14
 2007 |  0.06900000000000000000 |     60
 2008 |  0.16196261682242990654 |    107
 2009 |  0.36477611940298507463 |     67
 2010 |  0.16302631578947368421 |     76
 2011 | -0.08070796460176991150 |    113
 2012 |  0.10992248062015503876 |    129
 2013 |  0.24456140350877192982 |     57
 2014 |  0.32666666666666666667 |     12
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.17091603053435114504 |    131
 2001 | -0.03977941176470588235 |    136
 2002 | -0.03000000000000000000 |    116
 2003 |  0.12428571428571428571 |     21
 2004 |  0.14226415094339622642 |     53
 2005 |  0.13641025641025641026 |     78
 2006 |  0.51250000000000000000 |     12
 2007 |  0.11815384615384615385 |     65
 2008 |  0.13752212389380530973 |    113
 2009 |  0.13454545454545454545 |     55
 2010 |  0.14985294117647058824 |     68
 2011 |  0.17387931034482758621 |    116
 2012 |  0.12006622516556291391 |    151
 2013 |  0.29387096774193548387 |     93
 2014 |  0.71888888888888888889 |     10
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.32283464566929133858 |    127
 2001 | -0.10720588235294117647 |    136
 2002 | -0.28256637168141592920 |    113
 2003 | -0.15520833333333333333 |     48
 2004 | -0.17276595744680851064 |     47
 2005 |  0.15802721088435374150 |    147
 2006 |  0.70285714285714285714 |      7
 2007 |  0.72916666666666666667 |     72
 2008 | -0.36445378151260504202 |    119
 2009 |  0.12084745762711864407 |     59
 2010 |  0.73526315789473684211 |     76
 2011 |  0.28639455782312925170 |    147
 2012 |  0.54215277777777777778 |    144
 2013 |  0.64309734513274336283 |    113
 2014 |  0.47500000000000000000 |     29
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.06384615384615384615 |     52
 2001 |  0.00545454545454545455 |     44
 2002 | -0.18985074626865671642 |     67
 2003 |  0.18519480519480519481 |     77
 2004 | -0.04703703703703703704 |     27
 2005 |  0.19083333333333333333 |     12
 2006 | -0.00533333333333333333 |     90
 2007 | -0.11586206896551724138 |     29
 2008 | -0.65606060606060606061 |     66
 2009 | -0.02120000000000000000 |     75
 2010 |  0.01725000000000000000 |     40
 2011 | -0.14545454545454545455 |     33
 2012 |  0.14130434782608695652 |     23
 2013 |  0.11795454545454545455 |     44
 2014 |  0.00714285714285714286 |      8
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.09435897435897435897 |     39
 2001 | -0.24033333333333333333 |     30
 2002 | -0.46111111111111111111 |     45
 2003 |  0.26842105263157894737 |    114
 2004 |  0.08179487179487179487 |     39
 2005 |  0.32058823529411764706 |     17
 2006 |  0.03357798165137614679 |    109
 2007 | -0.41741935483870967742 |     31
 2008 | -0.52500000000000000000 |     54
 2009 |  0.18522935779816513761 |    109
 2010 |  0.21830188679245283019 |     53
 2011 | -0.04968750000000000000 |     32
 2012 | -0.32190476190476190476 |     21
 2013 |  0.03053571428571428571 |     56
 2014 | -0.19555555555555555556 |      9
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.83425000000000000000 |     40
 2001 | -0.75151515151515151515 |     33
 2002 | -0.54656250000000000000 |     64
 2003 |  0.51326530612244897959 |     98
 2004 | -0.11464285714285714286 |     28
 2005 |  0.21500000000000000000 |      4
 2006 |  0.07133802816901408451 |    142
 2007 | -0.62216666666666666667 |     60
 2008 |     -1.8333333333333333 |     63
 2009 |  0.84566371681415929204 |    113
 2010 | -0.12675675675675675676 |     74
 2011 | -0.57431818181818181818 |     44
 2012 | -0.56454545454545454545 |     33
 2013 |  0.05408450704225352113 |     71
 2014 | -0.46571428571428571429 |      8
(15 rows)

--
SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.10452451858862759647 |    107
 2001 | -0.02124735222089116476 |     97
 2002 | -0.01344935870431263778 |    100
 2003 |  0.09413990328014077446 |     26
 2004 |  0.24099230981318387119 |     33
 2005 |  0.06923401314553381137 |     47
 2006 |  0.63843611665395909584 |     14
 2007 |  0.06070656606561234528 |     60
 2008 |  0.05473492261401418860 |    107
 2009 |  0.19517357195235490667 |     67
 2010 |  0.10636474742359384838 |     76
 2011 | -0.05148973393085797216 |    113
 2012 |  0.12263239055099567915 |    129
 2013 |  0.32928677199627762112 |     57
 2014 |  0.47270991029273502945 |     12
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.07797268098373991822 |    131
 2001 | -0.01945975888157000238 |    136
 2002 | -0.01224314662475672565 |    116
 2003 |  0.05365545205322150402 |     21
 2004 |  0.13858286340201876690 |     53
 2005 |  0.16446369508868938004 |     78
 2006 |  0.53350103171772807529 |     12
 2007 |  0.08278126616849074230 |     65
 2008 |  0.03409075919775428493 |    113
 2009 |  0.04649905847250250255 |     55
 2010 |  0.07835177269042294064 |     68
 2011 |  0.08915928916910545396 |    116
 2012 |  0.09660396274821922360 |    151
 2013 |  0.37723036645085610381 |     93
 2014 |  1.01726164707914501536 |     10
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.11844721232265491002 |    127
 2001 | -0.03157868187493477068 |    136
 2002 | -0.06952462053813611391 |    113
 2003 | -0.04976459209874374593 |     48
 2004 | -0.12630540404324654050 |     47
 2005 |  0.11633564165524404080 |    147
 2006 |  0.59179558453975520382 |      7
 2007 |  0.32606057341237616587 |     72
 2008 | -0.07309775074622566940 |    119
 2009 |  0.02627997312221354448 |     59
 2010 |  0.28861701538651655251 |     76
 2011 |  0.08946335984317025400 |    147
 2012 |  0.31285062476265688368 |    144
 2013 |  0.54017921240298047612 |    113
 2014 |  0.34634443714026625258 |     29
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.05551307352987265982 |     52
 2001 |  0.00511727514964918002 |     44
 2002 | -0.12814954946350394788 |     67
 2003 |  0.16252027732732310220 |     77
 2004 | -0.08264368125933665660 |     27
 2005 |  0.27467297264754678827 |     12
 2006 | -0.00968109955258699861 |     90
 2007 | -0.10877902407041783908 |     29
 2008 | -0.26865559123343570462 |     66
 2009 | -0.01289764315805178230 |     75
 2010 |  0.01735687409636771032 |     40
 2011 | -0.09357823493222059993 |     33
 2012 |  0.18159231240004734056 |     23
 2013 |  0.20317395112179244732 |     44
 2014 |  0.01815319570391460912 |      8
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.05291595246668847257 |     39
 2001 | -0.14014100680133509272 |     30
 2002 | -0.19495787755529152281 |     45
 2003 |  0.21280417182615662872 |    114
 2004 |  0.09674800172079803954 |     39
 2005 |  0.48964409674318390741 |     17
 2006 |  0.04349660848349729227 |    109
 2007 | -0.36951442692785050382 |     31
 2008 | -0.18870874466678305969 |     54
 2009 |  0.08798295615573565973 |    109
 2010 |  0.15784320096021525478 |     53
 2011 | -0.02483897327622161944 |     32
 2012 | -0.32954032223281686487 |     21
 2013 |  0.02957479636141238836 |     56
 2014 | -0.16521250289735711638 |      9
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.26550939513253121842 |     40
 2001 | -0.34348695306333868346 |     33
 2002 | -0.17744567167743891072 |     64
 2003 |  0.27908319879325315982 |     98
 2004 | -0.08406717157398439832 |     28
 2005 |  0.31179073032452172794 |      4
 2006 |  0.05603068602108626130 |    142
 2007 | -0.34419597849003308139 |     60
 2008 | -0.43786964858039509287 |     63
 2009 |  0.24821106610302396491 |    113
 2010 | -0.05434237717623852361 |     74
 2011 | -0.21342383272333805733 |     44
 2012 | -0.33416755340820590652 |     33
 2013 |  0.03384839601816010502 |     71
 2014 | -0.21673021763377802120 |      8
(15 rows)

--
SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.04597359406242912456 |    153
 2001 | -0.01244732788983374313 |    155
 2002 | -0.05896426024646075651 |    143
 2003 |  0.04050680397291666931 |     92
 2004 | -0.02178250698287499932 |    114
 2005 |  0.06410573674393123835 |    166
 2006 |  0.31360895533894346265 |     72
 2007 |  0.07452978043375849309 |    155
 2008 |  0.07017147875883654568 |    147
 2009 |  0.11755238694287903226 |    115
 2010 |  0.00845849065415742170 |    144
 2011 | -0.02617309103937592743 |    158
 2012 |  0.08605975951699136995 |    194
 2013 |  0.21538116934658526683 |    143
 2014 |  0.11760645381319351050 |     42
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.03792931028444359392 |    169
 2001 | -0.03670539553191113021 |    187
 2002 | -0.04154640537939305396 |    160
 2003 | -0.04080527049369765873 |     54
 2004 |  0.09442638516900239336 |    131
 2005 |  0.09470742519108507554 |    168
 2006 |  0.23960795872591255601 |     66
 2007 |  0.05543281461353919107 |    159
 2008 | -0.04258743915471373030 |    160
 2009 |  0.04589016420007517348 |    102
 2010 |  0.11212664045265203835 |    130
 2011 |  0.01362740572611063251 |    177
 2012 |  0.14337968232859852684 |    198
 2013 |  0.26041049772153339507 |    137
 2014 |  0.19537721662419639520 |     38
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.06254221104542499043 |    179
 2001 | -0.07065033724662337808 |    179
 2002 | -0.09993256159310470289 |    138
 2003 |  0.05488848700960890776 |     88
 2004 |  0.08424557215972263883 |    125
 2005 |  0.14016493877512500493 |    227
 2006 |  0.81093741420528329453 |     37
 2007 |  0.23829496217482062513 |    122
 2008 | -0.07680253162756811601 |    159
 2009 |  0.00913604240461046218 |     95
 2010 |  0.26880566328031785402 |    126
 2011 |  0.11076613411874594360 |    179
 2012 |  0.23898637966519097718 |    187
 2013 |  0.44330296094056323489 |    155
 2014 |  0.45504389149070049145 |     43
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.18908982097293619568 |     99
 2001 | -0.05118268615450068663 |     93
 2002 | -0.03584250452043037937 |    109
 2003 |  0.10211696406306477028 |    160
 2004 |  0.11784472350797548872 |    138
 2005 | -0.01969462275357659554 |     86
 2006 | -0.03864046569236255152 |    179
 2007 | -0.11373985228268784048 |     96
 2008 | -0.24014205549416408367 |    106
 2009 |  0.00315751866093145017 |    137
 2010 |  0.11641148773738577091 |    108
 2011 |  0.06337940561664970734 |     94
 2012 |  0.00836766981396341173 |     56
 2013 |  0.02418024175115858431 |    109
 2014 | -0.09994394927498207274 |     26
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.17918242562567371339 |     83
 2001 | -0.06837297598072175697 |     61
 2002 | -0.13608335122516212952 |     92
 2003 |  0.19306794666621878691 |    198
 2004 |  0.02058156445505974034 |    121
 2005 | -0.00847428766794881842 |     84
 2006 |  0.04700150715046741350 |    185
 2007 | -0.06046766320740793391 |     92
 2008 | -0.19800384969293497294 |     93
 2009 |  0.10980127280474250944 |    150
 2010 |  0.00772946121228937380 |    122
 2011 |  0.00855651942810538184 |     75
 2012 | -0.10942499134668925858 |     52
 2013 |  0.13767410908134461689 |    115
 2014 | -0.12430681077971654804 |     30
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.31448077086055285558 |     73
 2001 | -0.04668625132815646320 |     69
 2002 | -0.14832833961149992106 |    114
 2003 |  0.31577382390951060331 |    164
 2004 |  0.08352805263851587244 |    127
 2005 | -0.10812632128079053431 |     25
 2006 |  0.08172281867582211355 |    214
 2007 | -0.20744591772407983317 |    129
 2008 | -0.35212268971072538140 |     94
 2009 |  0.23126576056501740880 |    157
 2010 | -0.07743556396388055927 |    126
 2011 | -0.25190119932576695626 |     73
 2012 | -0.06012707154003939122 |     63
 2013 |  0.19265227088906235370 |     97
 2014 | -0.33741968212631190255 |     25
(15 rows)

--
SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
;
         sharpe         | pcount 
------------------------+--------
 0.04278686620444765384 |   1993
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
;
         sharpe         | pcount 
------------------------+--------
 0.03118629857975558523 |   2036
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
;
         sharpe         | pcount 
------------------------+--------
 0.06771094175027548539 |   2039
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
;
         sharpe          | pcount 
-------------------------+--------
 -0.03057198887440722917 |   1596
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
;
         sharpe          | pcount 
-------------------------+--------
 -0.00539896819034012464 |   1553
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
;
         sharpe          | pcount 
-------------------------+--------
 -0.03231711744526961501 |   1550
(1 row)

