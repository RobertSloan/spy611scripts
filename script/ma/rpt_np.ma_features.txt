--
-- ~/spy611/script/ma/rpt_np.sql
--
-- For now this is a simple rpt.
-- Summarize first:
SELECT CORR(prob_willbetrue,pctgain) FROM np_n1dg WHERE algo='gbm';
        corr        
--------------------
 0.0505773239422771
(1 row)

SELECT CORR(prob_willbetrue,pctgain) FROM np_n2dg WHERE algo='gbm';
        corr        
--------------------
 0.0739872950657052
(1 row)

SELECT CORR(prob_willbetrue,pctgain) FROM np_n1wg WHERE algo='gbm';
        corr        
--------------------
 0.0602716573089592
(1 row)

-- Yr drilldown:
SELECT TO_CHAR(ydate,'YYYY') yyyy,COUNT(ydate) pcount,CORR(prob_willbetrue,pctgain) FROM np_n1dg WHERE algo='gbm' GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY');
 yyyy | pcount |         corr         
------+--------+----------------------
 2000 |    252 |    0.167843850724152
 2001 |    248 |  -0.0398337024289287
 2002 |    252 |   0.0733105313158812
 2003 |    252 |    0.010821824259496
 2004 |    252 |   0.0282026937088001
 2005 |    252 | -0.00783357653754639
 2006 |    251 |   0.0918116474340241
 2007 |    251 |   0.0865462977873029
 2008 |    253 |   0.0892380224481528
 2009 |    252 |   0.0281135501289718
 2010 |    252 |   0.0459791775990185
 2011 |    252 |   0.0856990610465996
 2012 |    250 |  0.00914656282335832
 2013 |    252 |   0.0435460062571041
 2014 |     68 |   0.0258253252640469
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,COUNT(ydate) pcount,CORR(prob_willbetrue,pctgain) FROM np_n2dg WHERE algo='gbm' GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY');
 yyyy | pcount |         corr         
------+--------+----------------------
 2000 |    252 |    0.211252606323568
 2001 |    248 | -0.00937131757339064
 2002 |    252 |    0.145668264615457
 2003 |    252 |  0.00690521458625588
 2004 |    252 |   0.0459068415232748
 2005 |    252 | 0.000164254239485633
 2006 |    251 |    0.097642970482686
 2007 |    251 |    0.105159940185331
 2008 |    253 |    0.171094050782744
 2009 |    252 |  -0.0560021881025599
 2010 |    252 |   0.0543598524251709
 2011 |    252 |   0.0169099960508915
 2012 |    250 |    0.121517116838219
 2013 |    252 |    0.172470024557981
 2014 |     68 |   0.0952750784650414
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,COUNT(ydate) pcount,CORR(prob_willbetrue,pctgain) FROM np_n1wg WHERE algo='gbm' GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY');
 yyyy | pcount |        corr         
------+--------+---------------------
 2000 |    252 |   0.236645204065311
 2001 |    248 |  0.0342811721270245
 2002 |    252 |    0.15908298090795
 2003 |    252 |  0.0585795298689633
 2004 |    252 |  0.0187451723607521
 2005 |    252 |  0.0184601607019875
 2006 |    251 |  0.0979278856200947
 2007 |    251 |   0.218498193490356
 2008 |    253 |   0.096904884745196
 2009 |    252 | -0.0977412307495197
 2010 |    252 |   0.162530445290313
 2011 |    252 |  0.0959250941429968
 2012 |    250 |   0.313050977809145
 2013 |    252 | 0.00695300112803792
 2014 |     68 |  0.0942746745599029
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.01327956989247311828 |    186
 2001 |  0.02192592592592592593 |    135
 2002 | -0.04028089887640449438 |    178
 2003 |  0.10462962962962962963 |    162
 2004 |  0.05397058823529411765 |    136
 2005 | -0.01418604651162790698 |    172
 2006 |  0.07423357664233576642 |    137
 2007 |  0.04786982248520710059 |    169
 2008 | -0.02447058823529411765 |    170
 2009 |  0.05980392156862745098 |    102
 2010 |  0.09136986301369863014 |    146
 2011 |  0.05418300653594771242 |    153
 2012 |  0.09282051282051282051 |    195
 2013 |  0.08368421052631578947 |     95
 2014 |  0.06137931034482758621 |     30
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.03101522842639593909 |    197
 2001 |  0.02111888111888111888 |    143
 2002 | -0.05038461538461538462 |    182
 2003 |  0.18130434782608695652 |    161
 2004 |  0.13283464566929133858 |    127
 2005 |  0.01222891566265060241 |    166
 2006 |  0.12254901960784313725 |    102
 2007 |  0.12319526627218934911 |    169
 2008 | -0.14155279503105590062 |    161
 2009 | -0.12051282051282051282 |    117
 2010 |  0.13412087912087912088 |    182
 2011 |  0.15562043795620437956 |    137
 2012 |  0.19165803108808290155 |    193
 2013 |  0.31303797468354430380 |    158
 2014 |  0.17979591836734693878 |     51
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.13087628865979381443 |    194
 2001 | -0.04539682539682539683 |    126
 2002 | -0.26225988700564971751 |    177
 2003 |  0.46082051282051282051 |    195
 2004 |  0.26443181818181818182 |    176
 2005 |  0.21098522167487684729 |    203
 2006 |  0.35047945205479452055 |    146
 2007 |  0.22118343195266272189 |    169
 2008 | -0.46817142857142857143 |    175
 2009 |  0.41409836065573770492 |    122
 2010 |  0.42469135802469135802 |    162
 2011 |  0.03708029197080291971 |    137
 2012 |  0.57958823529411764706 |    170
 2013 |  0.59254901960784313725 |    102
 2014 |  0.29394736842105263158 |     42
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.11469696969696969697 |     66
 2001 | -0.09946902654867256637 |    113
 2002 | -0.18027027027027027027 |     74
 2003 |  0.04777777777777777778 |     90
 2004 |  0.01232758620689655172 |    116
 2005 |  0.10525000000000000000 |     80
 2006 |  0.01166666666666666667 |    114
 2007 | -0.05768292682926829268 |     82
 2008 | -0.37843373493975903614 |     83
 2009 |  0.11360000000000000000 |    150
 2010 | -0.00179245283018867925 |    106
 2011 | -0.05212121212121212121 |     99
 2012 | -0.06690909090909090909 |     55
 2013 |  0.09649681528662420382 |    157
 2014 |  0.01500000000000000000 |     38
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.09781818181818181818 |     55
 2001 | -0.22400000000000000000 |    105
 2002 | -0.47071428571428571429 |     70
 2003 |  0.15637362637362637363 |     91
 2004 | -0.01512000000000000000 |    125
 2005 |  0.13151162790697674419 |     86
 2006 |  0.06885906040268456376 |    149
 2007 | -0.17829268292682926829 |     82
 2008 | -0.55793478260869565217 |     92
 2009 |  0.44777777777777777778 |    135
 2010 |  0.01942857142857142857 |     70
 2011 | -0.13408695652173913043 |    115
 2012 | -0.14789473684210526316 |     57
 2013 | -0.03329787234042553191 |     94
 2014 | -0.30176470588235294118 |     17
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.95051724137931034483 |     58
 2001 | -0.34950819672131147541 |    122
 2002 | -0.76920000000000000000 |     75
 2003 |  0.31754385964912280702 |     57
 2004 | -0.19289473684210526316 |     76
 2005 | -0.09653061224489795918 |     49
 2006 |  0.01314285714285714286 |    105
 2007 | -0.35609756097560975610 |     82
 2008 |     -1.3970512820512821 |     78
 2009 |  0.54907692307692307692 |    130
 2010 | -0.06288888888888888889 |     90
 2011 |  0.07652173913043478261 |    115
 2012 | -0.34675000000000000000 |     80
 2013 |  0.37020000000000000000 |    150
 2014 | -0.07320000000000000000 |     26
(15 rows)

--
SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.10333333333333333333 |    144
 2001 | -0.03259259259259259259 |     81
 2002 | -0.03314685314685314685 |    143
 2003 |  0.12942857142857142857 |    105
 2004 | -0.01300000000000000000 |     80
 2005 |  0.03494845360824742268 |     97
 2006 |  0.09597222222222222222 |     72
 2007 |  0.06451327433628318584 |    113
 2008 |  0.06904411764705882353 |    136
 2009 | -0.06228915662650602410 |     83
 2010 |  0.08304878048780487805 |     82
 2011 |  0.03055555555555555556 |     90
 2012 |  0.08504587155963302752 |    109
 2013 |  0.30121212121212121212 |     33
 2014 |  0.00157894736842105263 |     19
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.07920245398773006135 |    163
 2001 | -0.06380952380952380952 |    105
 2002 | -0.01940000000000000000 |    150
 2003 |  0.13677083333333333333 |     96
 2004 |  0.18244897959183673469 |     49
 2005 |  0.06488095238095238095 |     84
 2006 |  0.21153846153846153846 |     52
 2007 |  0.06115044247787610619 |    113
 2008 | -0.16104838709677419355 |    124
 2009 | -0.31032258064516129032 |     93
 2010 |  0.05413461538461538462 |    104
 2011 |  0.39875000000000000000 |     80
 2012 |  0.21556603773584905660 |    106
 2013 |  0.41626865671641791045 |     67
 2014 |  0.28810810810810810811 |     37
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 |  0.28459119496855345912 |    159
 2001 |  0.08555555555555555556 |     90
 2002 | -0.09894409937888198758 |    161
 2003 |  0.55892405063291139241 |    158
 2004 |  0.27474576271186440678 |    118
 2005 |  0.16759493670886075949 |    158
 2006 |  0.34041666666666666667 |     96
 2007 |  0.26036496350364963504 |    137
 2008 | -0.69849315068493150685 |    146
 2009 |  0.39585585585585585586 |    111
 2010 |  0.48095238095238095238 |    105
 2011 |  0.20514285714285714286 |    105
 2012 |  0.92413793103448275862 |    116
 2013 |  0.70153846153846153846 |     39
 2014 |  0.19600000000000000000 |     28
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.24189189189189189189 |     37
 2001 |  0.07500000000000000000 |     74
 2002 | -0.30240000000000000000 |     50
 2003 |  0.12500000000000000000 |     46
 2004 | -0.01826923076923076923 |     52
 2005 |  0.17375000000000000000 |     24
 2006 |  0.03325581395348837209 |     43
 2007 | -0.12083333333333333333 |     36
 2008 | -0.33964912280701754386 |     57
 2009 |  0.06088235294117647059 |    102
 2010 |  0.09788461538461538462 |     52
 2011 | -0.26261904761904761905 |     42
 2012 | -0.16230769230769230769 |     13
 2013 |  0.04765432098765432099 |     81
 2014 | -0.09928571428571428571 |     14
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.35406250000000000000 |     32
 2001 | -0.26435897435897435897 |     78
 2002 | -0.60177777777777777778 |     45
 2003 |  0.19065217391304347826 |     46
 2004 |  0.09703703703703703704 |     54
 2005 |  0.23857142857142857143 |     14
 2006 |  0.03769230769230769231 |     65
 2007 | -0.31088235294117647059 |     34
 2008 | -0.60814814814814814815 |     54
 2009 |  0.34103092783505154639 |     97
 2010 |  0.04037037037037037037 |     27
 2011 | -0.25000000000000000000 |     58
 2012 | -0.21785714285714285714 |     14
 2013 |  0.06961538461538461538 |     26
 2014 | -0.49428571428571428571 |      7
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain) avg_pctgain,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |       avg_pctgain       | pcount 
------+-------------------------+--------
 2000 | -0.97594594594594594595 |     37
 2001 | -0.45423913043478260870 |     92
 2002 |     -1.0949019607843137 |     51
 2003 |  0.46625000000000000000 |     24
 2004 | -0.10714285714285714286 |     42
 2005 | -0.13000000000000000000 |     23
 2006 | -0.04089285714285714286 |     56
 2007 | -0.81020408163265306122 |     49
 2008 |     -1.6673846153846154 |     65
 2009 |  0.61269565217391304348 |    115
 2010 | -0.21491525423728813559 |     59
 2011 |  0.07173333333333333333 |     75
 2012 | -0.13069767441860465116 |     43
 2013 |  0.56921568627450980392 |    102
 2014 | -0.73647058823529411765 |     17
(15 rows)

--
SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.07283269781724888827 |    144
 2001 | -0.02185806064429577567 |     81
 2002 | -0.01855208043612945593 |    143
 2003 |  0.12190460151546278427 |    105
 2004 | -0.01684060441376371096 |     80
 2005 |  0.04793129956239907986 |     97
 2006 |  0.14203853610250222443 |     72
 2007 |  0.06513395800934198331 |    113
 2008 |  0.02664449919629109605 |    136
 2009 | -0.03322842178045209817 |     83
 2010 |  0.05552362510155648149 |     82
 2011 |  0.01626129377382744857 |     90
 2012 |  0.09250984316599275677 |    109
 2013 |  0.37237484785609396885 |     33
 2014 |  0.00174043644912942103 |     19
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.03938288058461151731 |    163
 2001 | -0.03158331124495396828 |    105
 2002 | -0.00774313999000605139 |    150
 2003 |  0.08936433603160160342 |     96
 2004 |  0.20270100148391392972 |     49
 2005 |  0.06985872935204023793 |     84
 2006 |  0.20852104414823331238 |     52
 2007 |  0.04903456233070614683 |    113
 2008 | -0.04049489173133007339 |    124
 2009 | -0.11774028830371288947 |     93
 2010 |  0.03119210517560321100 |    104
 2011 |  0.17509100526590902007 |     80
 2012 |  0.17615673377682152096 |    106
 2013 |  0.46765691338819077840 |     67
 2014 |  0.28703070510550699907 |     37
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.52
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.10064483767693295482 |    159
 2001 |  0.02620387868068085575 |     90
 2002 | -0.02570699530884900425 |    161
 2003 |  0.22983117095688815333 |    158
 2004 |  0.19910063021582137621 |    118
 2005 |  0.12840748008902842695 |    158
 2006 |  0.27273133300603159064 |     96
 2007 |  0.12715242562917121637 |    137
 2008 | -0.16715965513273327451 |    146
 2009 |  0.10289028119228675430 |    111
 2010 |  0.20430526290313654446 |    105
 2011 |  0.05203983545694364922 |    105
 2012 |  0.56703530079322948212 |    116
 2013 |  0.54692686671670814210 |     39
 2014 |  0.18022020246000020399 |     28
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.20090189861720591856 |     37
 2001 |  0.05875563264462842190 |     74
 2002 | -0.19821900735849772270 |     50
 2003 |  0.11518538746108569506 |     46
 2004 | -0.02934881123868219345 |     52
 2005 |  0.41902458959884074741 |     24
 2006 |  0.06395251928757948817 |     43
 2007 | -0.11089124189648556744 |     36
 2008 | -0.10338081214192614893 |     57
 2009 |  0.03709981963398969156 |    102
 2010 |  0.11560669004859447023 |     52
 2011 | -0.19965006729568114722 |     42
 2012 | -0.43949543667697955721 |     13
 2013 |  0.09089790602450289004 |     81
 2014 | -0.24478467859592354341 |     14
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.21268356672364946592 |     32
 2001 | -0.13832326325457499199 |     78
 2002 | -0.27297586378436525344 |     45
 2003 |  0.14799214049826057271 |     46
 2004 |  0.09567187643854313409 |     54
 2005 |  0.39658775920258150404 |     14
 2006 |  0.05138995988083593765 |     65
 2007 | -0.20852242334265444982 |     34
 2008 | -0.20386697630812743649 |     54
 2009 |  0.16589187455785959942 |     97
 2010 |  0.02373144369552044962 |     27
 2011 | -0.14190254957675148428 |     58
 2012 | -0.43501642898135095781 |     14
 2013 |  0.06589896713365924536 |     26
 2014 | -0.39625424429779347168 |      7
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.48
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.43238145441486050724 |     37
 2001 | -0.16583476484373871210 |     92
 2002 | -0.44168345118374044400 |     51
 2003 |  0.24385974979622980016 |     24
 2004 | -0.07000104596382265878 |     42
 2005 | -0.10875260563856407352 |     23
 2006 | -0.03548207531004763589 |     56
 2007 | -0.39448035078273187090 |     49
 2008 | -0.31783008127415316764 |     65
 2009 |  0.18535560215216174689 |    115
 2010 | -0.09627828689619007656 |     59
 2011 |  0.03207863616165608637 |     75
 2012 | -0.08731525501491325064 |     43
 2013 |  0.42815905332881027730 |    102
 2014 | -0.41386514670106549272 |     17
(15 rows)

--
SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.00887061663397760262 |    186
 2001 |  0.01552566698564762789 |    135
 2002 | -0.02355711930390443914 |    178
 2003 |  0.10051655173881519359 |    162
 2004 |  0.07260210622342159327 |    136
 2005 | -0.02040035393338391598 |    172
 2006 |  0.11171087534740217707 |    137
 2007 |  0.04921058777250525520 |    169
 2008 | -0.01007765793462331391 |    170
 2009 |  0.03035121582062598884 |    102
 2010 |  0.07264885485730084327 |    146
 2011 |  0.03278808073550151322 |    153
 2012 |  0.10859980083150666600 |    195
 2013 |  0.09583072741030984717 |     95
 2014 |  0.06685509112819944571 |     30
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.01486693275759196022 |    197
 2001 |  0.01053528512592784570 |    143
 2002 | -0.02125086777840622811 |    182
 2003 |  0.12899005241387503083 |    161
 2004 |  0.13708825908263003352 |    127
 2005 |  0.01404459180193552761 |    166
 2006 |  0.12355716459900461285 |    102
 2007 |  0.09849209685465354294 |    169
 2008 | -0.03870613639040528897 |    161
 2009 | -0.04793302708082015144 |    117
 2010 |  0.08540647589368724410 |    182
 2011 |  0.07395720782706193690 |    137
 2012 |  0.15181006046417403556 |    193
 2013 |  0.37062214135072730870 |    158
 2014 |  0.17248859770800453611 |     51
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 |  0.04478834696048153937 |    194
 2001 | -0.01361994963202666548 |    126
 2002 | -0.06887809861068779652 |    177
 2003 |  0.19906604070320906077 |    195
 2004 |  0.18006036522796422941 |    176
 2005 |  0.16229504006416412615 |    203
 2006 |  0.28625566214390071207 |    146
 2007 |  0.10909008487599892752 |    169
 2008 | -0.11403180535782759852 |    175
 2009 |  0.10741673925887578730 |    122
 2010 |  0.16864920091321909833 |    162
 2011 |  0.01027058818857220798 |    137
 2012 |  0.33551473319341707089 |    170
 2013 |  0.46044701170068403463 |    102
 2014 |  0.21629885287782018781 |     42
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.10108151078306813687 |     66
 2001 | -0.07843883577756951946 |    113
 2002 | -0.11906656292230985002 |     74
 2003 |  0.04394804837332232609 |     90
 2004 |  0.01897056015638579634 |    116
 2005 |  0.19139609576125136491 |     80
 2006 |  0.02039467312820539379 |    114
 2007 | -0.05293679723957176641 |     82
 2008 | -0.13098094215129773780 |     83
 2009 |  0.07496456924922243311 |    150
 2010 | -0.00190106085384987648 |    106
 2011 | -0.04619237305443787515 |     99
 2012 | -0.10455071439054938239 |     55
 2013 |  0.17916321253833182453 |    157
 2014 |  0.02405329352893920452 |     38
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.06298242345550292200 |     55
 2001 | -0.12527720347279701863 |    105
 2002 | -0.22430412003734989339 |     70
 2003 |  0.11520168690552802724 |     91
 2004 | -0.01475530747222174523 |    125
 2005 |  0.15170277686702035545 |     86
 2006 |  0.08548395910761599143 |    149
 2007 | -0.12755117550672148915 |     82
 2008 | -0.20188724667640079259 |     92
 2009 |  0.22321867041111422778 |    135
 2010 |  0.01256446505985823288 |     70
 2011 | -0.07669353693897766051 |    115
 2012 | -0.18736634989576731198 |     57
 2013 | -0.03325818687642945096 |     94
 2014 | -0.26793215938966847210 |     17
(15 rows)

SELECT TO_CHAR(ydate,'YYYY') yyyy,AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
GROUP BY TO_CHAR(ydate,'YYYY') ORDER BY TO_CHAR(ydate,'YYYY')
;
 yyyy |         sharpe          | pcount 
------+-------------------------+--------
 2000 | -0.41749907200774726713 |     58
 2001 | -0.13303336832461806656 |    122
 2002 | -0.29281843861218912232 |     75
 2003 |  0.18425749395374967277 |     57
 2004 | -0.12446594924663607589 |     76
 2005 | -0.07823732896902567162 |     49
 2006 |  0.00995628517421714998 |    105
 2007 | -0.18182331956856697900 |     82
 2008 | -0.28333243577790668109 |     78
 2009 |  0.16558024672761973706 |    130
 2010 | -0.02830425471959241870 |     90
 2011 |  0.03557727726820060783 |    115
 2012 | -0.20297326113127734669 |     80
 2013 |  0.25388739964139095432 |    150
 2014 | -0.03647450347990950369 |     26
(15 rows)

--
SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
;
         sharpe         | pcount 
------------------------+--------
 0.02872953137638397786 |   2166
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
;
         sharpe         | pcount 
------------------------+--------
 0.04142996208613113849 |   2246
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue >= 0.5
;
         sharpe         | pcount 
------------------------+--------
 0.07326566334815081597 |   2296
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
;
         sharpe          | pcount 
-------------------------+--------
 -0.01685858472398491225 |   1423
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n2dg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
;
         sharpe          | pcount 
-------------------------+--------
 -0.03019325818997262391 |   1343
(1 row)

SELECT AVG(pctgain)/STDDEV(pctgain) sharpe,COUNT(ydate) pcount
FROM np_n1wg
WHERE algo='gbm' 
AND prob_willbetrue < 0.5
;
         sharpe          | pcount 
-------------------------+--------
 -0.06087335667245841088 |   1293
(1 row)

--
-- ~/spy611/script/ma/restore_ip.sql
--
DROP TABLE ip_n1dg;
DROP TABLE
DROP TABLE ip_n2dg;
DROP TABLE
DROP TABLE ip_n1wg;
DROP TABLE
CREATE TABLE ip_n1dg AS SELECT algo,ydate,prob1 prob_willbetrue,100*n1dg pctgain FROM my_vectors_ip_bak0409;
SELECT 39632
CREATE TABLE ip_n2dg AS SELECT algo,ydate,prob2 prob_willbetrue,100*n2dg pctgain FROM my_vectors_ip_bak0409;
SELECT 39632
CREATE TABLE ip_n1wg AS SELECT algo,ydate,prob3 prob_willbetrue,100*n1wg pctgain FROM my_vectors_ip_bak0409;
SELECT 39632
--
-- ~/spy611/script/ma/restore_np.sql
--
DROP TABLE np_n1dg;
DROP TABLE
DROP TABLE np_n2dg;
DROP TABLE
DROP TABLE np_n1wg;
DROP TABLE
CREATE TABLE np_n1dg AS SELECT * FROM np_n1dg_bak0409;
SELECT 14356
CREATE TABLE np_n2dg AS SELECT * FROM np_n2dg_bak0409;
SELECT 14356
CREATE TABLE np_n1wg AS SELECT * FROM np_n1wg_bak0409;
SELECT 14356
dan@cen110 ~/spy611/script/ma $ 
dan@cen110 ~/spy611/script/ma $ 
